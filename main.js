/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// src/main.ts
var main_exports = {};
__export(main_exports, {
  default: () => RpgClock,
  urlRegex: () => urlRegex
});
module.exports = __toCommonJS(main_exports);
var import_obsidian4 = require("obsidian");

// src/clock.ts
var import_obsidian = require("obsidian");
var Clock = class extends import_obsidian.MarkdownRenderChild {
  constructor(plugin, settings, containerEl, input) {
    super(containerEl);
    this.plugin = plugin;
    this.settings = settings;
    this.input = input;
    this.clocks = [];
  }
  onload() {
    console.log("onload: clean");
    this.containerEl.innerHTML = "";
    this.clocks = this.input.split("\n");
    this.clocks.forEach((clock) => {
      const [clockName, clockValue, clockColor] = clock.split(":");
      const [filled, total] = clockValue ? clockValue.split("/") : clockName.split("/");
      this.createClock(clockValue ? clockName : "", parseInt(filled, 10), parseInt(total, 10), clockColor);
    });
  }
  unload() {
    var _a;
    if (this.clocks[0] !== "Invalid Clock") {
      (_a = this.plugin.clocks) == null ? void 0 : _a.remove(this);
    }
  }
  refresh() {
    this.containerEl.empty();
    console.log("refresh");
  }
  /**
   * Add a new clock to html element
   * @param clockName 
   * @param filled 
   * @param totalCount 
   */
  createClock(clockName, filled, totalCount, color) {
    let { clockColor } = this.settings;
    if (color) {
      clockColor = color;
    }
    console.log("Create clock: ", clockName, `${filled}/${totalCount}`);
    this.containerEl.innerHTML += `<div class="clock" n="${totalCount}" style="--n: ${totalCount}; --clock-color:${clockColor}">
        <div class="description">${clockName}</div>
            <div class="widget">
                <div class="core">
                    ${this._slices(totalCount, filled)}
                    ${this._bars(totalCount)}
                </div>
            </div>
        </div>`;
  }
  /**
   * Generate slices
   * @param count 
   * @param filled 
   * @returns 
   */
  _slices(count, filled) {
    return new Array(count).fill(0).reduce((a, _, i) => [...a, `<div class="slice" i="${i}" ${filled <= i ? "" : "filled"} style="--i: ${i};"></div>`], []).join("\n");
  }
  /**
   * Generate Bars
   * @param count 
   * @returns 
   */
  _bars(count) {
    return new Array(count).fill(0).reduce((a, _, i) => [...a, ` <div class="bar" i="${i}" style="--i: ${i};">
                                            <div class="paint"></div>
                                        </div>`], []).join("\n");
  }
};

// src/settings.ts
var import_obsidian2 = require("obsidian");
var DefaultSettings = {
  clockSize: 150,
  clockColor: "#ff5757"
};
var SettingsTab = class extends import_obsidian2.PluginSettingTab {
  constructor(app, plugin) {
    super(app, plugin);
    this.plugin = plugin;
  }
  display() {
    const { containerEl } = this;
    let { settings } = this.plugin;
    containerEl.empty();
    new import_obsidian2.Setting(containerEl).setName("Clock Size").setDesc("How big the clock should be").addText((text) => {
      text.setValue(settings.clockSize.toString()).onChange(async (value) => {
        settings.clockSize = Number(value);
        await this.plugin.saveSettings();
      });
    });
    new import_obsidian2.Setting(containerEl).setName("Clock Color").setDesc("Which color should be the clock").addColorPicker((colorPicker) => {
      colorPicker.setValue(settings.clockColor).onChange(async (value) => {
        settings.clockColor = value;
        await this.plugin.saveSettings();
      });
    });
  }
  hide() {
    var _a;
    if ((_a = this.plugin) == null ? void 0 : _a.clocks) {
      for (let palette of this.plugin.clocks) {
        palette.refresh();
      }
    }
  }
};

// src/commandInput.ts
var import_obsidian3 = require("obsidian");
var CommandInput = class extends import_obsidian3.Modal {
  constructor(app, onSubmit) {
    super(app);
    this.onSubmit = onSubmit;
  }
  onOpen() {
    const { contentEl } = this;
    contentEl.createEl("h1", { text: "Clock name" });
    new import_obsidian3.Setting(contentEl).setName("name").addText((text) => {
      text.onChange((value) => {
        this.result = value;
      });
    });
    new import_obsidian3.Setting(contentEl).addButton(
      (btn) => btn.setButtonText("enter").setCta().onClick(() => {
        this.close();
        this.onSubmit(this.result);
      })
    );
  }
  onClose() {
    let { contentEl } = this;
    contentEl.empty();
  }
};

// src/main.ts
var urlRegex = /\/([^\/]+)\/?$/;
var RpgClock = class extends import_obsidian4.Plugin {
  async onload() {
    this.clocks = [];
    await this.loadSettings();
    this.registerMarkdownCodeBlockProcessor(
      "clock",
      async (source, el, ctx) => {
        ctx.addChild(new Clock(this, this.settings, el, source.trim()));
      }
    );
    this.addCommand({
      id: "insert-clock",
      name: "Insert Clock",
      editorCallback: (editor) => {
        new CommandInput(this.app, (result) => {
          console.log("aniuest");
          try {
            const codeBlock = `\`\`\`clock
${result}:0/4
\`\`\`
`;
            const cursor = editor.getCursor();
            editor.transaction({
              changes: [{ from: cursor, text: codeBlock }]
            });
            editor.setCursor({
              line: cursor.line + codeBlock.split("\n").length,
              ch: 0
            });
            new import_obsidian4.Notice(`Added ${result}`);
          } catch (error) {
            new import_obsidian4.Notice(error);
          }
        }).open();
      }
    });
    this.addSettingTab(new SettingsTab(this.app, this));
  }
  async loadSettings() {
    this.settings = Object.assign({}, DefaultSettings, await this.loadData());
  }
  async saveSettings() {
    await this.saveData(this.settings);
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsic3JjL21haW4udHMiLCAic3JjL2Nsb2NrLnRzIiwgInNyYy9zZXR0aW5ncy50cyIsICJzcmMvY29tbWFuZElucHV0LnRzIl0sCiAgInNvdXJjZXNDb250ZW50IjogWyJpbXBvcnQgeyBFZGl0b3IsIE1hcmtkb3duUG9zdFByb2Nlc3NvckNvbnRleHQsIE5vdGljZSwgUGx1Z2luIH0gZnJvbSAnb2JzaWRpYW4nXG5pbXBvcnQgeyBDbG9jayB9IGZyb20gJ3NyYy9jbG9jayc7XG5pbXBvcnQgeyBScGdDbG9ja1NldHRpbmdzLCBEZWZhdWx0U2V0dGluZ3MsIFNldHRpbmdzVGFiIH0gZnJvbSAnc3JjL3NldHRpbmdzJztcbmltcG9ydCB7IENvbW1hbmRJbnB1dCB9IGZyb20gJy4vY29tbWFuZElucHV0JztcblxuZXhwb3J0IGNvbnN0IHVybFJlZ2V4ID0gL1xcLyhbXlxcL10rKVxcLz8kL1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBScGdDbG9jayBleHRlbmRzIFBsdWdpbiB7XG5cdHNldHRpbmdzOiBScGdDbG9ja1NldHRpbmdzO1xuXHRjbG9ja3M/OiBDbG9ja1tdO1xuXG5cdGFzeW5jIG9ubG9hZCgpIHtcblx0XHR0aGlzLmNsb2NrcyA9IFtdO1xuXHRcdGF3YWl0IHRoaXMubG9hZFNldHRpbmdzKCk7XG5cblx0XHR0aGlzLnJlZ2lzdGVyTWFya2Rvd25Db2RlQmxvY2tQcm9jZXNzb3IoXG5cdFx0XHQnY2xvY2snLFxuXHRcdFx0YXN5bmMgKHNvdXJjZTogc3RyaW5nLCBlbDogSFRNTEVsZW1lbnQsIGN0eDogTWFya2Rvd25Qb3N0UHJvY2Vzc29yQ29udGV4dCkgPT4ge1xuXHRcdFx0XHRjdHguYWRkQ2hpbGQobmV3IENsb2NrKHRoaXMsIHRoaXMuc2V0dGluZ3MsIGVsLCBzb3VyY2UudHJpbSgpKSk7XG5cdFx0XHR9XG5cdFx0KVxuXG5cdFx0XG5cdFx0dGhpcy5hZGRDb21tYW5kKHtcblx0XHRcdGlkOiAnaW5zZXJ0LWNsb2NrJyxcblx0XHRcdG5hbWU6ICdJbnNlcnQgQ2xvY2snLFxuXHRcdFx0ZWRpdG9yQ2FsbGJhY2s6IChlZGl0b3I6IEVkaXRvcikgPT4ge1xuXHRcdFx0XHRuZXcgQ29tbWFuZElucHV0KHRoaXMuYXBwLCAocmVzdWx0KSA9PiB7XG5cdFx0XHRcdFx0Y29uc29sZS5sb2coXCJhbml1ZXN0XCIpO1xuXHRcdFx0XHRcdHRyeSB7XG5cdFx0XHRcdFx0XHRjb25zdCBjb2RlQmxvY2sgPSBgXFxgXFxgXFxgY2xvY2tcXG4ke3Jlc3VsdH06MC80XFxuXFxgXFxgXFxgXFxuYDtcblx0XHRcdFx0XHRcdGNvbnN0IGN1cnNvciA9IGVkaXRvci5nZXRDdXJzb3IoKTtcblx0XHRcdFx0XHRcdGVkaXRvci50cmFuc2FjdGlvbih7XG5cdFx0XHRcdFx0XHRcdGNoYW5nZXM6IFt7IGZyb206IGN1cnNvciwgdGV4dDogY29kZUJsb2NrIH1dXG5cdFx0XHRcdFx0XHR9KVxuXHRcdFx0XHRcdFx0ZWRpdG9yLnNldEN1cnNvcih7XG5cdFx0XHRcdFx0XHRcdGxpbmU6IGN1cnNvci5saW5lICsgY29kZUJsb2NrLnNwbGl0KCdcXG4nKS5sZW5ndGgsXG5cdFx0XHRcdFx0XHRcdGNoOiAwXG5cdFx0XHRcdFx0XHR9KVxuXHRcdFx0XHRcdFx0bmV3IE5vdGljZShgQWRkZWQgJHtyZXN1bHR9YCk7XG5cdFx0XHRcdFx0fSBcblx0XHRcdFx0XHRjYXRjaCAoZXJyb3IpIHtcblx0XHRcdFx0XHRcdG5ldyBOb3RpY2UoZXJyb3IpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSlcblx0XHRcdFx0Lm9wZW4oKTtcblx0XHRcdH1cblx0XG5cdFx0fSlcblxuXHRcdHRoaXMuYWRkU2V0dGluZ1RhYihuZXcgU2V0dGluZ3NUYWIodGhpcy5hcHAsIHRoaXMpKTtcblx0fVxuXHRcblx0YXN5bmMgbG9hZFNldHRpbmdzKCkge1xuXHRcdHRoaXMuc2V0dGluZ3MgPSBPYmplY3QuYXNzaWduKHt9LCBEZWZhdWx0U2V0dGluZ3MsIGF3YWl0IHRoaXMubG9hZERhdGEoKSk7XG5cdH1cblxuXHRhc3luYyBzYXZlU2V0dGluZ3MoKSB7XG5cdFx0YXdhaXQgdGhpcy5zYXZlRGF0YSh0aGlzLnNldHRpbmdzKTtcblx0fVxufSIsICJpbXBvcnQgeyBNYXJrZG93blJlbmRlckNoaWxkIH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgUnBnQ2xvY2sgZnJvbSBcIi4vbWFpblwiO1xuaW1wb3J0IHsgQ29sb3IsIFJwZ0Nsb2NrU2V0dGluZ3MgfSBmcm9tIFwiLi9zZXR0aW5nc1wiO1xuXG5leHBvcnQgY2xhc3MgQ2xvY2sgZXh0ZW5kcyBNYXJrZG93blJlbmRlckNoaWxkIHtcbiAgICBwbHVnaW46IFJwZ0Nsb2NrO1xuICAgIHNldHRpbmdzOiBScGdDbG9ja1NldHRpbmdzO1xuXHRpbnB1dDogc3RyaW5nO1xuXHRjbG9ja3M6IHN0cmluZ1tdO1xuXG5cdGNvbnN0cnVjdG9yKHBsdWdpbjogUnBnQ2xvY2ssIHNldHRpbmdzOiBScGdDbG9ja1NldHRpbmdzLCBjb250YWluZXJFbDogSFRNTEVsZW1lbnQsIGlucHV0OiBzdHJpbmcpIHtcblx0ICBzdXBlcihjb250YWluZXJFbCk7XG4gICAgICB0aGlzLnBsdWdpbiA9IHBsdWdpbjtcbiAgICAgIHRoaXMuc2V0dGluZ3MgPSBzZXR0aW5ncztcblx0ICB0aGlzLmlucHV0ID0gaW5wdXQ7XG5cdCAgdGhpcy5jbG9ja3MgPSBbXTtcblx0fVxuICBcblx0b25sb2FkKCkge1xuICAgICAgICBjb25zb2xlLmxvZyhcIm9ubG9hZDogY2xlYW5cIik7XG4gICAgICAgIHRoaXMuY29udGFpbmVyRWwuaW5uZXJIVE1MID0gXCJcIjtcblxuICAgICAgICAvLyBtdWx0aXBsZSBkZWZpbml0aW9uc1xuICAgICAgICB0aGlzLmNsb2NrcyA9IHRoaXMuaW5wdXQuc3BsaXQoXCJcXG5cIik7XG4gICAgICAgIFxuICAgICAgICB0aGlzLmNsb2Nrcy5mb3JFYWNoKChjbG9jayk9PntcbiAgICAgICAgICAgIGNvbnN0IFtjbG9ja05hbWUsY2xvY2tWYWx1ZSxjbG9ja0NvbG9yXSA9IGNsb2NrLnNwbGl0KFwiOlwiKTtcbiAgICAgICAgICAgIGNvbnN0IFtmaWxsZWQsIHRvdGFsXSA9IGNsb2NrVmFsdWU/IGNsb2NrVmFsdWUuc3BsaXQoXCIvXCIpOmNsb2NrTmFtZS5zcGxpdChcIi9cIik7XG4gICAgICAgICAgICB0aGlzLmNyZWF0ZUNsb2NrKGNsb2NrVmFsdWU/IGNsb2NrTmFtZTpcIlwiLCBwYXJzZUludChmaWxsZWQsMTApLHBhcnNlSW50KHRvdGFsLDEwKSxjbG9ja0NvbG9yIGFzIENvbG9yKTtcbiAgICAgICAgfSk7XG5cdH1cblxuICAgIHVubG9hZCgpIHtcbiAgICAgICAgLy8gUmVtb3ZlIHBhbGV0dGUgZnJvbSBzdGF0ZVxuICAgICAgICBpZih0aGlzLmNsb2Nrc1swXSAhPT0gJ0ludmFsaWQgQ2xvY2snKXtcbiAgICAgICAgICAgIHRoaXMucGx1Z2luLmNsb2Nrcz8ucmVtb3ZlKHRoaXMpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHVibGljIHJlZnJlc2goKXtcbiAgICAgICAgdGhpcy5jb250YWluZXJFbC5lbXB0eSgpO1xuICAgICAgICBjb25zb2xlLmxvZyhcInJlZnJlc2hcIik7XG4gICAgfVxuICAgIFxuICAgIC8qKlxuICAgICAqIEFkZCBhIG5ldyBjbG9jayB0byBodG1sIGVsZW1lbnRcbiAgICAgKiBAcGFyYW0gY2xvY2tOYW1lIFxuICAgICAqIEBwYXJhbSBmaWxsZWQgXG4gICAgICogQHBhcmFtIHRvdGFsQ291bnQgXG4gICAgICovXG4gICAgcHVibGljIGNyZWF0ZUNsb2NrKGNsb2NrTmFtZTpzdHJpbmcsIGZpbGxlZDpudW1iZXIsdG90YWxDb3VudDpudW1iZXIsY29sb3I6Q29sb3Ipe1xuICAgICAgICBsZXQge2Nsb2NrQ29sb3J9ID0gdGhpcy5zZXR0aW5ncztcbiAgICAgICAgaWYoY29sb3Ipe1xuICAgICAgICAgICAgY2xvY2tDb2xvcj1jb2xvcjtcbiAgICAgICAgfVxuICAgICAgICBjb25zb2xlLmxvZyhcIkNyZWF0ZSBjbG9jazogXCIsIGNsb2NrTmFtZSAsIGAke2ZpbGxlZH0vJHt0b3RhbENvdW50fWApO1xuICAgICAgICB0aGlzLmNvbnRhaW5lckVsLmlubmVySFRNTCs9YDxkaXYgY2xhc3M9XCJjbG9ja1wiIG49XCIke3RvdGFsQ291bnR9XCIgc3R5bGU9XCItLW46ICR7dG90YWxDb3VudH07IC0tY2xvY2stY29sb3I6JHtjbG9ja0NvbG9yfVwiPlxuICAgICAgICA8ZGl2IGNsYXNzPVwiZGVzY3JpcHRpb25cIj4ke2Nsb2NrTmFtZX08L2Rpdj5cbiAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJ3aWRnZXRcIj5cbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwiY29yZVwiPlxuICAgICAgICAgICAgICAgICAgICAke3RoaXMuX3NsaWNlcyh0b3RhbENvdW50LCBmaWxsZWQpfVxuICAgICAgICAgICAgICAgICAgICAke3RoaXMuX2JhcnModG90YWxDb3VudCl9XG4gICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgPC9kaXY+YFxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdlbmVyYXRlIHNsaWNlc1xuICAgICAqIEBwYXJhbSBjb3VudCBcbiAgICAgKiBAcGFyYW0gZmlsbGVkIFxuICAgICAqIEByZXR1cm5zIFxuICAgICAqL1xuICAgIHByaXZhdGUgX3NsaWNlcyhjb3VudDpudW1iZXIsZmlsbGVkOm51bWJlcil7XG4gICAgICAgIHJldHVybiBuZXcgQXJyYXkoY291bnQpXG4gICAgICAgICAgICAuZmlsbCgwKVxuICAgICAgICAgICAgLnJlZHVjZSgoYSxfLGkpID0+IFsuLi5hLCBgPGRpdiBjbGFzcz1cInNsaWNlXCIgaT1cIiR7aX1cIiAke2ZpbGxlZDw9aT9cIlwiOlwiZmlsbGVkXCJ9IHN0eWxlPVwiLS1pOiAke2l9O1wiPjwvZGl2PmBdLFtdKVxuICAgICAgICAgICAgLmpvaW4oXCJcXG5cIik7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2VuZXJhdGUgQmFyc1xuICAgICAqIEBwYXJhbSBjb3VudCBcbiAgICAgKiBAcmV0dXJucyBcbiAgICAgKi9cbiAgICBwcml2YXRlIF9iYXJzKGNvdW50Om51bWJlcil7XG4gICAgICAgIHJldHVybiBuZXcgQXJyYXkoY291bnQpXG4gICAgICAgICAgICAuZmlsbCgwKVxuICAgICAgICAgICAgLy8ucmVkdWNlKChhLF8saSkgPT4gWy4uLmEsIGA8ZGl2IGNsYXNzPVwic2xpY2VcIiBpPVwiJHtpfVwiICR7ZmlsbGVkPD1pP1wiXCI6XCJmaWxsZWRcIn0gc3R5bGU9XCItLWk6ICR7aX07XCI+PC9kaXY+YF0sW10pXG4gICAgICAgICAgICAucmVkdWNlKChhLF8saSkgPT4gWy4uLmEsIGAgPGRpdiBjbGFzcz1cImJhclwiIGk9XCIke2l9XCIgc3R5bGU9XCItLWk6ICR7aX07XCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJwYWludFwiPjwvZGl2PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PmBdLFtdKVxuICAgICAgICAgICAgLmpvaW4oXCJcXG5cIik7XG4gICAgfVxuXG59IiwgImltcG9ydCBScGdDbG9jayBmcm9tIFwiLi9tYWluXCI7XG5pbXBvcnQgeyBBcHAsIFBsdWdpblNldHRpbmdUYWIsIFNldHRpbmcgfSBmcm9tIFwib2JzaWRpYW5cIjtcblxudHlwZSBSR0IgPSBgcmdiKCR7bnVtYmVyfSwgJHtudW1iZXJ9LCAke251bWJlcn0pYDtcbnR5cGUgUkdCQSA9IGByZ2JhKCR7bnVtYmVyfSwgJHtudW1iZXJ9LCAke251bWJlcn0sICR7bnVtYmVyfSlgO1xudHlwZSBIRVggPSBgIyR7c3RyaW5nfWA7XG5cbmV4cG9ydCB0eXBlIENvbG9yID0gUkdCIHwgUkdCQSB8IEhFWDtcblxuZXhwb3J0IGludGVyZmFjZSBScGdDbG9ja1NldHRpbmdzIHtcbiAgICBjbG9ja1NpemU6IG51bWJlcjtcbiAgICBjbG9ja0NvbG9yOiBDb2xvclxufVxuXG5leHBvcnQgY29uc3QgRGVmYXVsdFNldHRpbmdzOiBScGdDbG9ja1NldHRpbmdzID0ge1xuICAgIGNsb2NrU2l6ZTogMTUwLFxuICAgIGNsb2NrQ29sb3I6ICcjZmY1NzU3Jyxcbn1cblxuZXhwb3J0IGNsYXNzIFNldHRpbmdzVGFiIGV4dGVuZHMgUGx1Z2luU2V0dGluZ1RhYiB7XG4gICAgcGx1Z2luOiBScGdDbG9jaztcblxuICAgIGNvbnN0cnVjdG9yKGFwcDogQXBwLCBwbHVnaW46IFJwZ0Nsb2NrKXtcbiAgICAgICAgc3VwZXIoYXBwLCBwbHVnaW4pO1xuICAgICAgICB0aGlzLnBsdWdpbiA9IHBsdWdpbjtcbiAgICB9XG5cbiAgICBkaXNwbGF5KCkge1xuICAgICAgICBjb25zdCB7IGNvbnRhaW5lckVsIH0gPSB0aGlzO1xuICAgICAgICBsZXQgeyBzZXR0aW5ncyB9ID0gdGhpcy5wbHVnaW47XG4gICAgICAgIFxuICAgICAgICBjb250YWluZXJFbC5lbXB0eSgpO1xuICAgICAgICBcbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG4gICAgICAgICAgICAuc2V0TmFtZSgnQ2xvY2sgU2l6ZScpXG4gICAgICAgICAgICAuc2V0RGVzYygnSG93IGJpZyB0aGUgY2xvY2sgc2hvdWxkIGJlJylcbiAgICAgICAgICAgIC5hZGRUZXh0KCh0ZXh0KSA9PiB7XG4gICAgICAgICAgICAgICAgdGV4dFxuICAgICAgICAgICAgICAgICAgICAuc2V0VmFsdWUoc2V0dGluZ3MuY2xvY2tTaXplLnRvU3RyaW5nKCkpXG4gICAgICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNldHRpbmdzLmNsb2NrU2l6ZSA9IE51bWJlcih2YWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICB9KVxuXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuICAgICAgICAgICAgLnNldE5hbWUoJ0Nsb2NrIENvbG9yJylcbiAgICAgICAgICAgIC5zZXREZXNjKCdXaGljaCBjb2xvciBzaG91bGQgYmUgdGhlIGNsb2NrJylcbiAgICAgICAgICAgIC5hZGRDb2xvclBpY2tlcigoY29sb3JQaWNrZXIpID0+IHtcbiAgICAgICAgICAgICAgICBjb2xvclBpY2tlclxuICAgICAgICAgICAgICAgICAgICAuc2V0VmFsdWUoc2V0dGluZ3MuY2xvY2tDb2xvcilcbiAgICAgICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgc2V0dGluZ3MuY2xvY2tDb2xvciA9IHZhbHVlIGFzIENvbG9yO1xuICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICB9KVxuICAgIH1cblxuICAgIGhpZGUoKSB7XG4gICAgICAgIGlmKHRoaXMucGx1Z2luPy5jbG9ja3Mpe1xuICAgICAgICAgICAgZm9yKGxldCBwYWxldHRlIG9mIHRoaXMucGx1Z2luLmNsb2Nrcyl7XG4gICAgICAgICAgICAgICAgcGFsZXR0ZS5yZWZyZXNoKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG59IiwgImltcG9ydCB7IEFwcCwgTW9kYWwsIFNldHRpbmcgfSBmcm9tIFwib2JzaWRpYW5cIjtcblxuZXhwb3J0IGNsYXNzIENvbW1hbmRJbnB1dCBleHRlbmRzIE1vZGFsIHtcbiAgICByZXN1bHQ6IHN0cmluZztcbiAgICBvblN1Ym1pdDogKHJlc3VsdDogc3RyaW5nKSA9PiB2b2lkXG5cbiAgICBjb25zdHJ1Y3RvcihhcHA6IEFwcCwgb25TdWJtaXQ6IChyZXN1bHQ6IHN0cmluZykgPT4gdm9pZCkge1xuICAgICAgICBzdXBlcihhcHApO1xuICAgICAgICB0aGlzLm9uU3VibWl0ID0gb25TdWJtaXQ7XG4gICAgfVxuXG4gICAgb25PcGVuKCk6IHZvaWQge1xuICAgICAgICBjb25zdCB7IGNvbnRlbnRFbCB9ID0gdGhpcztcbiAgICAgICAgXG4gICAgICAgIGNvbnRlbnRFbC5jcmVhdGVFbCgnaDEnLCB7IHRleHQ6ICdDbG9jayBuYW1lJyB9KVxuXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRlbnRFbClcbiAgICAgICAgLnNldE5hbWUoXCJuYW1lXCIpXG4gICAgICAgIC5hZGRUZXh0KCh0ZXh0KSA9PiB7XG4gICAgICAgICAgICB0ZXh0Lm9uQ2hhbmdlKCh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMucmVzdWx0ID0gdmFsdWU7XG4gICAgICAgICAgICB9KVxuICAgICAgICB9KVxuXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRlbnRFbClcbiAgICAgICAgLmFkZEJ1dHRvbigoYnRuKSA9PiBcbiAgICAgICAgICAgIGJ0blxuICAgICAgICAgICAgLnNldEJ1dHRvblRleHQoXCJlbnRlclwiKVxuICAgICAgICAgICAgLnNldEN0YSgpXG4gICAgICAgICAgICAub25DbGljaygoKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgICAgICAgICAgIHRoaXMub25TdWJtaXQodGhpcy5yZXN1bHQpO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgKVxuICAgIH1cblxuICAgIG9uQ2xvc2UoKTogdm9pZCB7XG4gICAgICAgIGxldCB7IGNvbnRlbnRFbCB9ID0gdGhpcztcbiAgICAgICAgY29udGVudEVsLmVtcHR5KCk7XG4gICAgfVxufSJdLAogICJtYXBwaW5ncyI6ICI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBLElBQUFBLG1CQUFxRTs7O0FDQXJFLHNCQUFvQztBQUk3QixJQUFNLFFBQU4sY0FBb0Is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QUNDLGNBQWMsT0FBTyxFQUNyQixPQUFPLEVBQ1AsUUFBUSxNQUFNO0FBQ1gsYUFBSyxNQUFNO0FBQ1gsYUFBSyxTQUFTLEtBQUssTUFBTTtBQUFBLE1BQzdCLENBQUM7QUFBQSxJQUNMO0FBQUEsRUFDSjtBQUFBLEVBRUEsVUFBZ0I7QUFDWixRQUFJLEVBQUUsVUFBVSxJQUFJO0FBQ3BCLGNBQVUsTUFBTTtBQUFBLEVBQ3BCO0FBQ0o7OztBSG5DTyxJQUFNLFdBQVc7QUFFeEIsSUFBcUIsV0FBckIsY0FBc0Msd0JBQU87QUFBQSxFQUk1QyxNQUFNLFNBQVM7QUFDZCxTQUFLLFNBQVMsQ0FBQztBQUNmLFVBQU0sS0FBSyxhQUFhO0FBRXhCLFNBQUs7QUFBQSxNQUNKO0FBQUEsTUFDQSxPQUFPLFFBQWdCLElBQWlCLFFBQXNDO0FBQzdFLFlBQUksU0FBUyxJQUFJLE1BQU0sTUFBTSxLQUFLLFVBQVUsSUFBSSxPQUFPLEtBQUssQ0FBQyxDQUFDO0FBQUEsTUFDL0Q7QUFBQSxJQUNEO0FBR0EsU0FBSyxXQUFXO0FBQUEsTUFDZixJQUFJO0FBQUEsTUFDSixNQUFNO0FBQUEsTUFDTixnQkFBZ0IsQ0FBQyxXQUFtQjtBQUNuQyxZQUFJLGFBQWEsS0FBSyxLQUFLLENBQUMsV0FBVztBQUN0QyxrQkFBUSxJQUFJLFNBQVM7QUFDckIsY0FBSTtBQUNILGtCQUFNLFlBQVk7QUFBQSxFQUFnQixNQUFNO0FBQUE7QUFBQTtBQUN4QyxrQkFBTSxTQUFTLE9BQU8sVUFBVTtBQUNoQyxtQkFBTyxZQUFZO0FBQUEsY0FDbEIsU0FBUyxDQUFDLEVBQUUsTUFBTSxRQUFRLE1BQU0sVUFBVSxDQUFDO0FBQUEsWUFDNUMsQ0FBQztBQUNELG1CQUFPLFVBQVU7QUFBQSxjQUNoQixNQUFNLE9BQU8sT0FBTyxVQUFVLE1BQU0sSUFBSSxFQUFFO0FBQUEsY0FDMUMsSUFBSTtBQUFBLFlBQ0wsQ0FBQztBQUNELGdCQUFJLHdCQUFPLFNBQVMsTUFBTSxFQUFFO0FBQUEsVUFDN0IsU0FDTyxPQUFPO0FBQ2IsZ0JBQUksd0JBQU8sS0FBSztBQUFBLFVBQ2pCO0FBQUEsUUFDRCxDQUFDLEVBQ0EsS0FBSztBQUFBLE1BQ1A7QUFBQSxJQUVELENBQUM7QUFFRCxTQUFLLGNBQWMsSUFBSSxZQUFZLEtBQUssS0FBSyxJQUFJLENBQUM7QUFBQSxFQUNuRDtBQUFBLEVBRUEsTUFBTSxlQUFlO0FBQ3BCLFNBQUssV0FBVyxPQUFPLE9BQU8sQ0FBQyxHQUFHLGlCQUFpQixNQUFNLEtBQUssU0FBUyxDQUFDO0FBQUEsRUFDekU7QUFBQSxFQUVBLE1BQU0sZUFBZTtBQUNwQixVQUFNLEtBQUssU0FBUyxLQUFLLFFBQVE7QUFBQSxFQUNsQztBQUNEOyIsCiAgIm5hbWVzIjogWyJpbXBvcnRfb2JzaWRpYW4iLCAiaW1wb3J0X29ic2lkaWFuIiwgImltcG9ydF9vYnNpZGlhbiJdCn0K
